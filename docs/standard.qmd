---
title: "Quantitative Reasoning Indirect Assessment Report"
format: 
  html:
    theme: cosmo
    toc: true
    toc-depth: 3
    toc-location: right
    number-sections: true
    self-contained: true
    anchor-sections: true
    warning: false
    message: false
  docx: 
    reference-doc: "QR_Report_Template.docx"
    toc: true
    number-sections: true
editor: source
editor_options: 
  chunk_output_type: console
echo: false
warning: false
message: false
---

```{r setup}
#| include: false
#| warning: false
#| message: false
#| echo: false

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

# Install and load packages
while (dev.cur() > 1) dev.off()
packages <- c("dplyr", "gtsummary", "officer", "flextable", "labelled", 
              "sjPlot", "ggplot2", "corrplot", "Hmisc", "GGally", "psych", "quarto", "readr")
invisible(lapply(setdiff(packages, rownames(installed.packages())), install.packages))
invisible(
  lapply(packages, function(pkg) {
    suppressWarnings(suppressMessages(library(pkg, character.only = TRUE)))}))

# Read data
df <- read.csv("df.csv", check.names = FALSE, stringsAsFactors = FALSE)

# Setup
var_names <- c("q1_methodology", "q2_calculation", "q3_visual_representation", "q4_interpretation",
               "q5_evaluation", "q6_coherence_purpose", "q7_reasonableness", "q8_used_qr",
               "q9_improve_general", "q10_improve_realworld", "q11_confidence", "q12_example_qr_class",
               "q13_freq_calculations", "q14_freq_graphs_tables", "q15_freq_course_situations", "q16_example_qr_life")
names(df)[2:min(17, ncol(df))] <- var_names[1:min(16, ncol(df)-1)]


# Variable groups
vars <- list(
  likert = intersect(c("q1_methodology", "q2_calculation", "q3_visual_representation", "q4_interpretation", "q5_evaluation", "q6_coherence_purpose", "q7_reasonableness", "q8_used_qr", "q13_freq_calculations", "q14_freq_graphs_tables", "q15_freq_course_situations"), names(df)),
  improvement = intersect(c("q9_improve_general", "q10_improve_realworld"), names(df)),
  confidence = intersect("q11_confidence", names(df)),
  openended = intersect(c("q12_example_qr_class", "q16_example_qr_life"), names(df)))

# Core QR Skills
qr_core_likert <- intersect(c("q1_methodology", "q2_calculation", "q3_visual_representation", 
"q4_interpretation", "q5_evaluation", "q6_coherence_purpose", "q7_reasonableness"), names(df))

# QR Application and Confidence
qr_impr_conf <- intersect(c("q9_improve_general", "q10_improve_realworld", "q11_confidence"), names(df))

# Frequency of QR Engagement
frq_qr_eng <- intersect(c("q8_used_qr", "q13_freq_calculations", "q14_freq_graphs_tables", "q15_freq_course_situations"), names(df))

# QR Confidence 
qr_conf <- intersect(c("q11_confidence"), names(df))

# Value maps and labels
maps <- list(
  values = list(
    likert = c("Never" = 1, "Infrequently" = 2, "Sometimes" = 3, "Frequently" = 4),
    improvement = c("None" = 1, "Minor improvement" = 2, "Moderate improvement" = 3, "Major improvement" = 4),
    confidence = c("1" = 1, "2" = 2, "3" = 3, "4" = 4)),
  labels = list(
    likert = c("Never", "Infrequently", "Sometimes", "Frequently"),
    improvement = c("None", "Minor improvement", "Moderate improvement", "Major improvement"),
    confidence = c("Not at all confident", "Not confident", "Confident", "Very confident")))

# Variable labels
var_labels <- c(
  q1_methodology = "[Methodology] Described the methods used to solve a quantitative problem and why they were appropriate",
  q2_calculation = "[Calculation] Carried out calculations, either by hand or using software",
  q3_visual_representation = "[Visual Representation] Created a visual representation of numerical information (graph, table, chart, etc.)",
  q4_interpretation = "[Interpretation] Described numerical information (numbers, graphs, statistics, etc.) by writing in words",
  q5_evaluation = "[Evaluation] Reached conclusions based on your own analysis of numerical information (numbers, graphs, statistics, etc.)",
  q6_coherence_purpose = "[Coherence/Purpose] Constructed a single, coherent argument using several conclusions that were each based on quantitative evidence",
  q7_reasonableness = "[Reasonableness] Decided when a solution or inference was reasonable or not reasonable in the context of a problem",
  q8_used_qr = "[QR in World Issues] Used quantitative reasoning to examine a real-world problem or issue",
  q9_improve_general = "[Improved General QR] How much has this course improved your general quantitative/numerical skills?",
  q10_improve_realworld = "[Improved Applied QR] How much has this course improved your ability to apply QR to real-world problems?",
  q11_confidence = "[Confidence] How confident do you feel using numbers in your everyday life?",
  q12_example_qr_class = "[Example of a QR skill] Example of a quantitative skill that you developed in this course that you feel will be important in the future",
  q13_freq_calculations = "[Frequency of Calculations] How frequently do you do calculations in your everyday life?",
  q14_freq_graphs_tables = "[Frequency of Graph Use] How frequently do you encounter graphs and tables in your everyday life?",
  q15_freq_course_situations = "[Frequency of Encounters] How frequently in your daily life do you encounter situations like those you have learned about in this course?",
  q16_example_qr_life = "[Example of using QR skill] Example of a time when you used 'quantitative reasoning' in your daily life"
)
var_labels <- var_labels[names(var_labels) %in% names(df)]

# Short labels
shortlabels <- list(
  q1_methodology = "Methodology",
  q2_calculation = "Calculation",
  q3_visual_representation = "Visual Representation",
  q4_interpretation = "Interpretation",
  q5_evaluation = "Evaluation",
  q6_coherence_purpose = "Coherence/Purpose",
  q7_reasonableness = "Reasonableness",
  q8_used_qr = "QR in World Issues",
  q9_improve_general = "Improved General QR",
  q10_improve_realworld = "Improved Applied QR",
  q11_confidence = "Confidence",
  q12_example_qr_class = "Example class",
  q13_freq_calculations = "Frequency of Calculations",
  q14_freq_graphs_tables = "Frequency of Graph Use",
  q15_freq_course_situations = "Frequency of Encounters",
  q16_example_qr_life = "Example life"
  )

# Create numeric and factor datasets
df_numeric <- df
df_factor <- df

# Numeric values
if(length(vars$likert) > 0) 
  df_numeric[vars$likert] <- lapply(df[vars$likert], function(x) as.numeric(maps$values$likert[x]))
if(length(vars$improvement) > 0) 
  df_numeric[vars$improvement] <- lapply(df[vars$improvement], function(x) as.numeric(maps$values$improvement[x]))
if(length(vars$confidence) > 0) 
  df_numeric[vars$confidence] <- lapply(df[vars$confidence], function(x) as.numeric(maps$values$confidence[as.character(x)]))

# Factor dataset
df_factor[c(vars$likert, vars$improvement, vars$confidence)] <- df_numeric[c(vars$likert, vars$improvement, vars$confidence)]

if(length(vars$likert) > 0) 
  df_factor[vars$likert] <- lapply(df_factor[vars$likert], function(x) factor(x, 1:4, maps$labels$likert))
if(length(vars$improvement) > 0) 
  df_factor[vars$improvement] <- lapply(df_factor[vars$improvement], function(x) factor(x, 1:4, maps$labels$improvement))
if(length(vars$confidence) > 0) 
  df_factor[vars$confidence] <- lapply(df_factor[vars$confidence], function(x) factor(x, 1:4, maps$labels$confidence))

for(var in names(var_labels)) {
  if(var %in% names(df)) {
    attr(df_factor[[var]], "label") <- var_labels[var]
    attr(df_numeric[[var]], "label") <- var_labels[var]}}

# Creating indexes
df_numeric <- df_numeric %>%
  rowwise() %>% 
  mutate (qr_skills_index = mean (c(q1_methodology, q2_calculation, q3_visual_representation, q4_interpretation,
                             q5_evaluation,q6_coherence_purpose,q7_reasonableness)))

df_numeric <- df_numeric %>%
  rowwise() %>% 
  mutate (qr_improvement_index = mean (c(q9_improve_general, q10_improve_realworld)))

df_numeric <- df_numeric %>%
  rowwise() %>% 
  mutate (qr_engagement_index = mean (c(q8_used_qr, q13_freq_calculations, q14_freq_graphs_tables, q15_freq_course_situations)))

#  Mean centering for multicollinearity
df_numeric$q1_methodology_cent <-scale(df_numeric$q1_methodology, center = TRUE, scale = FALSE)
df_numeric$q2_calculation_cent <-scale(df_numeric$q2_calculation, center = TRUE, scale = FALSE)
df_numeric$q3_visual_representation_cent <-scale(df_numeric$q3_visual_representation, center = TRUE, scale = FALSE)
df_numeric$q4_interpretation_cent <-scale(df_numeric$q4_interpretation, center = TRUE, scale = FALSE)
df_numeric$q5_evaluation_cent <-scale(df_numeric$q5_evaluation, center = TRUE, scale = FALSE)
df_numeric$q6_coherence_purpose_cent <-scale(df_numeric$q6_coherence_purpose, center = TRUE, scale = FALSE)
df_numeric$q7_reasonableness_cent <-scale(df_numeric$q7_reasonableness, center = TRUE, scale = FALSE)
df_numeric$q8_used_qr_cent <-scale(df_numeric$q8_used_qr, center = TRUE, scale = FALSE)
df_numeric$q9_improve_general_cent <-scale(df_numeric$q9_improve_general, center = TRUE, scale = FALSE)
df_numeric$q10_improve_realworld_cent <-scale(df_numeric$q10_improve_realworld, center = TRUE, scale = FALSE)
df_numeric$q11_confidence_cent <-scale(df_numeric$q11_confidence, center = TRUE, scale = FALSE)
df_numeric$q13_freq_calculations_cent <-scale(df_numeric$q13_freq_calculations, center = TRUE, scale = FALSE)
df_numeric$q14_freq_graphs_tables_cent <-scale(df_numeric$q14_freq_graphs_tables, center = TRUE, scale = FALSE)
df_numeric$q15_freq_course_situations_cent <-scale(df_numeric$q15_freq_course_situations, center = TRUE, scale = FALSE)
df_numeric$qr_skills_index_cent <-scale(df_numeric$qr_skills_index, center = TRUE, scale = FALSE)
df_numeric$qr_improvement_index_cent <-scale(df_numeric$qr_improvement_index, center = TRUE, scale = FALSE)
df_numeric$qr_engagement_index_cent <-scale(df_numeric$qr_engagement_index, center = TRUE, scale = FALSE)
```

# Study

## Background

A survey, Indirect Assessment in Quantitative Reasoning, was used to complement the [Quantitative Reasoning Rubric](https://drive.google.com/file/d/1eij-N3jRgmW2dth-U7Mz3qb-zrdcTRJk/view) for direct assessment.

## Method and Sample

The survey was distributed through Google Forms to assess quantitative reasoning skills and engagement using the "Standard Form."

The data was collected during the last two weeks of the Spring 2024 semester, resulting in 469 complete student responses.

## Variables

Variable names, full wording of the questions, short labels used in analyses, and the response sets are as follows.

```{r variables}

codebook <- data.frame(
  variable_name = c(
    "q1_methodology", "q2_calculation", "q3_visual_representation", 
    "q4_interpretation", "q5_evaluation", "q6_coherence_purpose", 
    "q7_reasonableness", "q8_used_qr", "q9_improve_general", 
    "q10_improve_realworld", "q11_confidence", "q12_example_qr_class",
    "q13_freq_calculations", "q14_freq_graphs_tables", "q15_freq_course_situations",
    "q16_example_qr_life"
  ),
  
  full_question = c(
    "[Methodology] Throughout this course, how often have you done each of the following?... Describe the methods that you chose to solve a quantitative problem and why they were appropriate.
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Calculation]... Carried out calculations, either by hand or using software.
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Visual Representation]... Created a visual representation of numerical information, such as a graph, table, chart, or diagram.
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Interpretation]... Described numerical information (numbers, graphs, statistics, etc.) by writing in words.
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Evaluation]... Reached conclusions based on your own analysis of numerical information (numbers, graphs, statistics, etc.)
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Coherence/Purpose]... Constructed a single, coherent argument using several conclusions that were each based on quantitative evidence.
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Reasonableness]... Decided when a solution or inference was reasonable or not reasonable in the context of a problem.
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[QR in World Issues]... Used quantitative reasoning to examine a real-world problem or issue (unemployment, climate change, public health, etc.)
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Improved General QR] Describe how much this course has improved your general quantitative/numerical skills.
    
None (1) / Minor improvement (2) / Moderate improvement (3) / Major improvement (4)",
    "[Improved Applied QR] Describe how much this course has improved your ability to apply your quantitative/numerical skills to real-world problems.
    
None (1) / Minor improvement (2) / Moderate improvement (3) / Major improvement (4)",
    "[Confidence] Describe how confident you feel using numbers in your everyday life.
    
None (1) / Minor improvement (2) / Moderate improvement (3) / Major improvement (4)",
    "[Example class] Please give an example of a quantitative skill that you developed in this course that you feel will be important in the future (such as in a future class, workplace, or daily life).
    
Open-ended question",
    "[Frequency of Calculations] How frequently do you do calculations in your everyday life?
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Frequency of Graph Use] How frequently do you encounter graphs and tables in your everyday life?
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Frequency of Encounters] How frequently in your daily life do you encounter situations like those you have learned about in this course?
    
Never (1) / Infrequently (2) / Sometimes (3) / Frequently (4)",
    "[Example life] Please give an example of a time when you used \"quantitative reasoning\" in your daily life.
    
Open-ended question"
  ), stringsAsFactors = FALSE)
  
ft <- flextable(codebook) %>%
  flextable::width(j = 1, width = 1.7) %>%  
  flextable::width(j = 2, width = 4.7) %>% 

  flextable::font(fontname = "Arial", part = "all") %>%
  flextable::fontsize(size = 9, part = "all") %>%
  flextable::padding(padding = 4, part = "all") %>%
  flextable::bold(part = "header") %>%
  flextable::set_header_labels(
    variable_name = "Variable Name",
    full_question = "[Short label] Full Wording of the Question and the Response Set"
  ) %>%
  flextable::border_outer() %>%
  flextable::border_inner_h()
ft
```

# Results

## Quantitative Reasoning Skills: Summary

### Table 1. Frequencies of Core Quantitative Reasoning Skills

```{r frequency-table-core}
if (length(qr_core_likert) > 0) {
  tbl <- df_factor %>% 
    select(all_of(qr_core_likert)) %>%
    tbl_summary(
      statistic = everything() ~ "{n} ({p}%)",
      missing = "no"
    ) %>%
    modify_header(label = "Core QR Skills - Items") %>%
    italicize_levels() %>%
    modify_table_body(
      ~ .x %>%
        dplyr::mutate(
          label = dplyr::if_else(variable != lag(variable) | is.na(lag(variable)), label, paste0("    ", label))
        )
    )
  tbl_flex <- as_flex_table(tbl) %>%
    flextable::width(j = 1, width = 5) %>%
    flextable::width(j = 2, width = 2) %>%
    flextable::font(fontname = "Arial", part = "all") %>%
    flextable::fontsize(size = 10, part = "all") %>%
    flextable::padding(padding = 1, part = "all")

  tbl_flex
}
```

**Table 1** presents the frequencies of student engagement in various quantitative activities within the class, measured through seven different questions.

"Carried out calculations, either by hand or using software," shows that a significant majority of students, 65%, frequently engage in calculations. "Created a visual representation, like a graph, chart, or diagram," indicates that 56.5% of students frequently create visual representations. "Interpreted numerical information by writing in words," shows 54.1% of students frequently interpret numerical data in written form.

The last three items received the least “frequently” responses display more advanced quantitative reasoning and analysis."Described the methods used to solve a quantitative problem and why they were appropriate" shows 40.3% of students frequently describe methodology. "Decided when a solution or inference was reasonable or not reasonable in the context of a problem" indicates that 38.2% of students frequently assess reasonableness. Finally, the item "Constructed a single, coherent argument using several conclusions that were each based on quantitative evidence" has the lowest "frequently" response at 34.2%, which is less common among students.

### Figure 1. Frequencies of Core Quantitative Reasoning Skills

```{r frequency-graph-core, fig.width=11, fig.height=7}
#| fig-cap: "Note 1: Alternative of the above table.<br>Note 2: The items are sorted by the responses that received the most 'frequently' responses."

value_labels <- c("1" = "Never", "2" = "Infrequently", "3" = "Sometimes", "4" = "Frequently")
graph <- df_numeric %>%  
  select(all_of(qr_core_likert)) %>%  
  plot_stackfrq(
    sort.frq = "last.desc", 
    coord.flip = TRUE, 
    geom.colors = "Blues", 
    show.total = FALSE,
    legend.labels = value_labels,
    axis.labels = shortlabels[qr_core_likert])
graph + theme(
  axis.text.x = element_text(size=14),  
  axis.text.y = element_text(size=14),  
  plot.title = element_text(size=14),  
  legend.text = element_text(size=14),
  legend.position = "bottom")
```

### Table 2. Descriptive Statistics of Core Quantitative Reasoning Skills

```{r descriptive-table-core}

if (length(qr_core_likert) > 0) {
  means <- sapply(df_numeric[qr_core_likert], mean, na.rm = TRUE)
  sorted_vars <- names(sort(means, decreasing = TRUE))

  tbl <- df_numeric %>%
    select(all_of(sorted_vars)) %>%
    tbl_summary(
      type = everything() ~ "continuous",
      statistic = everything() ~ "{mean} ({sd})",
      digits = everything() ~ 2,
      missing = "no"
    ) %>%
    modify_header(label = "Core QR Skills - Items")

  tbl_flex <- as_flex_table(tbl) %>%
    flextable::width(j = 1, width = 5) %>%
    flextable::width(j = 2, width = 2) %>%
    flextable::font(fontname = "Arial", part = "all") %>%
    flextable::fontsize(size = 10, part = "all") %>%
    flextable::padding(padding = 4, part = "all")

  tbl_flex
}
```

**Table 2** presents the descriptive statistics of core quantitative reasoning skills. The highest mean score is for "Calculation" at 3.55 out of four. "Visual representation" has a mean score of 3.43. "Interpretation" and "Evaluation" both have a mean score of 3.38. Students describe numerical information in written form and reach conclusions based on analysis at similar frequencies.

"Reasonableness" and "Methodology" both score 3.20. Students decide when solutions are reasonable in context and describe methods used to solve quantitative problems at moderate frequencies. "Coherence/Purpose," which involves constructing coherent arguments using multiple quantitative conclusions, has a mean score of 3.03. Students construct coherent arguments using several conclusions based on quantitative evidence less frequently than other skills.

The standard deviations range from 0.70 to 0.88, with "Coherence/Purpose" showing the highest variability among students (SD = 0.88). In contrast, "Calculation" (SD = 0.70) and "Visual Representation" (SD = 0.75) show more consistent performance across students.

### Figure 2. Descriptive Statistics of Quantitative Reasoning Skills

```{r descriptive-figure-core, fig.width=11, fig.height=7}
#| fig-cap: "Note: Alternative of the above table."
stats_df <- data.frame(
  variable = qr_core_likert,
  stringsAsFactors = FALSE)

for(var in qr_core_likert) {
  stats_df$mean[stats_df$variable == var] <- mean(df_numeric[[var]], na.rm = TRUE)
  stats_df$sd[stats_df$variable == var] <- sd(df_numeric[[var]], na.rm = TRUE)}

stats_df$label <- unlist(shortlabels[stats_df$variable])
stats_df$stat_label <- sprintf("%.2f (%.2f)", stats_df$mean, stats_df$sd)

ggplot(stats_df, aes(x = reorder(label, mean), y = mean)) +
  geom_col(fill = "#4682B4", width = 0.7) +
  geom_text(aes(label = stat_label), 
            hjust = -0.1,
            size = 4,
            color = "black") +
  scale_y_continuous(
    limits = c(0, 4.0),
    breaks = 1:4,
    labels = c("1\nNever", "2\nInfrequently", "3\nSometimes", "4\nFrequently"),
    expand = expansion(mult = c(0, 0.1))
  ) +
  labs(
    x = "",
    y = "Mean (SD) (1-4 scale)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 13),
    axis.text.y = element_text(size = 13),
    axis.title.x = element_text(size = 13),
    panel.grid.minor = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.major.x = element_line(color = "lightgray"),
    panel.background = element_rect(fill = "white", color = NA),
    plot.background = element_rect(fill = "white", color = NA),
    axis.line.x = element_line(color = "black"),
    plot.margin = margin(10, 60, 10, 10)
  ) +
  coord_flip()
```

## Quantitative Reasoning Improvement and Confidence: Summary

### Table 3. Frequencies of Quantitative Reasoning Improvement and Confidence

```{r frequency-table-improvement-confidence}
if (length(qr_impr_conf) > 0) {
  tbl <- df_factor %>%
    select(all_of(qr_impr_conf)) %>%
    tbl_summary(
      statistic = everything() ~ "{n} ({p}%)",
      missing = "no"
    ) %>%
    modify_header(label = "QR Improvement and Confidence - Items") %>%
    italicize_levels() %>%
    modify_table_body(
      ~ .x %>%
        dplyr::mutate(
          label = dplyr::if_else(variable != lag(variable) | is.na(lag(variable)), label, paste0("    ", label))
        )
    )

  tbl_flex <- as_flex_table(tbl) %>%
    flextable::width(j = 1, width = 5) %>%
    flextable::width(j = 2, width = 2) %>%
    flextable::font(fontname = "Arial", part = "all") %>%
    flextable::fontsize(size = 10, part = "all") %>%
    flextable::padding(padding = 1, part = "all")

  tbl_flex
}
```

**Table 3** presents the frequencies of student responses regarding course improvement and confidence in quantitative reasoning.

For general quantitative/numerical skills improvement, most students (57%) report moderate improvement, with 27% reporting major improvement. Only 6.8% of students indicate no improvement in their quantitative skills from the course.

Similarly, for applied QR skills improvement, 56% of students report moderate improvement and 27% report major improvement in their ability to apply quantitative reasoning to real-world problems. A small percentage (8.5%) report no improvement in this area.

Regarding confidence in using numbers in everyday life, the majority of students feel confident (60%) or very confident (32%). Only 2.6% of students report feeling not at all confident, with 5.8% feeling not confident in using numbers day-to-day.

### Figure 3. Frequencies of Quantitative Reasoning Improvement and Confidence

```{r frequency-graph-improvement-confidence, fig.width=11, fig.height=5}
#| fig-cap: "Note 1: Alternative of the above table.<br>Note 2: Different response scales are used: QR Improvement (1–4: None to Major improvement) and Confidence (1–4: Not at all confident to Very confident)."

value_labels <- c("1" = "1", "2" = "2", "3" = "3", "4" = "4")

graph <- df_numeric %>%  
  select(all_of(qr_impr_conf)) %>%
  plot_stackfrq(
    sort.frq = "last.desc", 
    coord.flip = TRUE, 
    geom.colors = "Blues", 
    show.total = FALSE,
    legend.labels = value_labels,
    axis.labels = shortlabels[qr_impr_conf]
  )
graph + theme(
  axis.text.x = element_text(size=13),  
  axis.text.y = element_text(size=13),  
  plot.title = element_text(size=13),  
  legend.text = element_text(size=13),
  legend.position = "bottom")
```

### Table 4. Descriptive Statistics of Quantitative Reasoning Improvement and Confidence

```{r descriptive-table-improvement-confidence, fig.width=7, fig.height=5}
if (length(qr_impr_conf) > 0) {
  means <- sapply(df_numeric[qr_impr_conf], mean, na.rm = TRUE)
  sorted_vars <- names(sort(means, decreasing = TRUE))

  tbl <- df_numeric %>%
    select(all_of(sorted_vars)) %>%
    tbl_summary(
      type = everything() ~ "continuous", 
      statistic = everything() ~ "{mean} ({sd})",
      digits = everything() ~ 2, 
      missing = "no"
    ) %>%
    modify_header(label = "QR Improvement and Confidence - Items")

  tbl_flex <- as_flex_table(tbl) %>%
    flextable::width(j = 1, width = 5) %>%
    flextable::width(j = 2, width = 2) %>%
    flextable::font(fontname = "Arial", part = "all") %>%
    flextable::fontsize(size = 10, part = "all") %>%
    flextable::padding(padding = 4, part = "all")

  tbl_flex
}

```

**Table 4** presents the descriptive statistics of student improvement and confidence measures. Students report high confidence in using numbers in everyday life (M = 3.21). This score is the highest among the three measures.

Applied quantitative skill improvement shows a mean of 3.06. Students report similar levels of improvement in applying quantitative reasoning to real-world problems, with a mean of 3.05.

### Figure 4. Descriptive Statistics of Quantitative Reasoning Improvement and Confidence

```{r descriptive-figure-improvement-confidence, fig.width=9, fig.height=5}
#| fig-cap: "Note 1: Alternative of the above table.<br>Note 2: Different response scales are used: QR Improvement (1-4: None to Major improvement) and Confidence (1-4: Not at all confident to Very confident)."

stats_df <- data.frame(
  variable = qr_impr_conf,
  stringsAsFactors = FALSE
)

for(var in qr_impr_conf) {
  stats_df$mean[stats_df$variable == var] <- mean(df_numeric[[var]], na.rm = TRUE)
  stats_df$sd[stats_df$variable == var] <- sd(df_numeric[[var]], na.rm = TRUE)}

stats_df$label <- unlist(shortlabels[stats_df$variable])
stats_df$stat_label <- sprintf("%.2f (%.2f)", stats_df$mean, stats_df$sd)

ggplot(stats_df, aes(x = reorder(label, mean), y = mean)) +
  geom_col(fill = "#4682B4", width = 0.7) +
  geom_text(aes(label = stat_label), 
            hjust = -0.1,
            size = 4,
            color = "black") +
  scale_y_continuous(
    limits = c(0, 4.0),
    breaks = 1:4,
    labels = c("1", "2", "3", "4"),
    expand = expansion(mult = c(0, 0.2))
  ) +
  labs(
    x = "",
    y = "Mean (SD) (1-4 scale)") +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    axis.title.x = element_text(size = 14),
    panel.grid.minor = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.major.x = element_line(color = "lightgray"),
    panel.background = element_rect(fill = "white", color = NA),
    plot.background = element_rect(fill = "white", color = NA),
    axis.line.x = element_line(color = "black"),
    plot.margin = margin(10, 60, 10, 10),
  ) +
  coord_flip()
```

## Quantitative Reasoning Engagement: Summary

### Table 5. Frequencies of Quantitative Reasoning Engagement

```{r frequency-table-engagement}
if (length(frq_qr_eng) > 0) {
  tbl <- df_factor %>%
    select(all_of(frq_qr_eng)) %>%
    tbl_summary(
      statistic = everything() ~ "{n} ({p}%)",
      missing = "no"
    ) %>%
    modify_header(label = "Frequency of QR Engagement - Items") %>%
    italicize_levels() %>%
    modify_table_body(
      ~ .x %>%
        dplyr::mutate(
          label = dplyr::if_else(variable != lag(variable) | is.na(lag(variable)), label, paste0("    ", label))
        )
    )

  tbl_flex <- as_flex_table(tbl) %>%
    flextable::width(j = 1, width = 5) %>%
    flextable::width(j = 2, width = 2) %>%
    flextable::font(fontname = "Arial", part = "all") %>%
    flextable::fontsize(size = 10, part = "all") %>%
    flextable::padding(padding = 1, part = "all")

  tbl_flex
}
```

**Table 5** presents the frequencies of student engagement with quantitative reasoning in various contexts.

For using quantitative reasoning to examine world issues, 37% of students do this frequently. For calculations in everyday life, 27% of students perform these frequently. Graph and table usage shows 15% of students encounter these frequently. Regarding course-related situations in daily life, 11% of students encounter these frequently.

These results show that quantitative reasoning skills are most frequently applied when examining world issues, followed by performing everyday calculations.

### Figure 5. Frequencies of Quantitative Reasoning Engagement

```{r frequency-graph-engagement, fig.width=9, fig.height=5}
#| fig-cap: "Note: Alternative of the above table."
value_labels <- c("1" = "Never", "2" = "Infrequently", "3" = "Sometimes", "4" = "Frequently")

graph <- df_numeric %>%  
    select(all_of(frq_qr_eng)) %>%
  plot_stackfrq(
    sort.frq = "last.desc", 
    coord.flip = TRUE, 
    geom.colors = "Blues", 
    show.total = FALSE,
    legend.labels = value_labels,
    axis.labels = shortlabels[frq_qr_eng]
  )
graph + theme(
  axis.text.x = element_text(size=13),  
  axis.text.y = element_text(size=13),  
  plot.title = element_text(size=13),  
  legend.text = element_text(size=13),
  legend.position = "bottom")
```

### Table 6. Descriptive Statistics of Quantitative Reasoning Engagement

```{r descriptive-table-engagement}
if (length(frq_qr_eng) > 0) {
  means <- sapply(df_numeric[frq_qr_eng], mean, na.rm = TRUE)
  sorted_vars <- names(sort(means, decreasing = TRUE))

  tbl <- df_numeric %>%
    select(all_of(sorted_vars)) %>%
    tbl_summary(
      type = everything() ~ "continuous", 
      statistic = everything() ~ "{mean} ({sd})",
      digits = everything() ~ 2, 
      missing = "no"
    ) %>%
    modify_header(label = "Frequency of QR Engagement - Items")

  tbl_flex <- as_flex_table(tbl) %>%
    flextable::width(j = 1, width = 5) %>%
    flextable::width(j = 2, width = 2) %>%
    flextable::font(fontname = "Arial", part = "all") %>%
    flextable::fontsize(size = 10, part = "all") %>%
    flextable::padding(padding = 4, part = "all")

  tbl_flex
}
```

**Table 6** presents the descriptive statistics of quantitative reasoning engagement measures.

Students most frequently use quantitative reasoning to examine world issues (M = 3.04). Frequency of calculations in everyday life shows a mean of 2.90. Graph and table usage displays a mean of 2.43.

Frequency of encountering course-related situations in daily life has the lowest mean at 2.38. Students experience situations similar to those taught in the course less frequently than other forms of quantitative engagement.

### Figure 6. Descriptive Statistics of Quantitative Reasoning Engagement

```{r descriptive-graph-engagement, fig.width=11, fig.height=5}
#| fig-cap: "Note: Alternative of the above table."
stats_df <- data.frame(
  variable = frq_qr_eng,
  stringsAsFactors = FALSE
)

for(var in frq_qr_eng) {
  stats_df$mean[stats_df$variable == var] <- mean(df_numeric[[var]], na.rm = TRUE)
  stats_df$sd[stats_df$variable == var] <- sd(df_numeric[[var]], na.rm = TRUE)}

stats_df$label <- unlist(shortlabels[stats_df$variable])
stats_df$stat_label <- sprintf("%.2f (%.2f)", stats_df$mean, stats_df$sd)

ggplot(stats_df, aes(x = reorder(label, mean), y = mean)) +
  geom_col(fill = "#4682B4", width = 0.7) +
  geom_text(aes(label = stat_label), 
            hjust = -0.1,
            size = 4,
            color = "black") +
  scale_y_continuous(
    limits = c(0, 4.0),
    breaks = 1:4,
    labels = c("1\nNever", "2\nInfrequently", "3\nSometimes", "4\nFrequently"),
    expand = expansion(mult = c(0, 0.1))  # Match Figure 2's expansion
  ) +
  labs(
    x = "",
    y = "Mean (SD) (1-4 scale)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 13),
    axis.text.y = element_text(size = 13),
    axis.title.x = element_text(size = 13),
    panel.grid.minor = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.major.x = element_line(color = "lightgray"),
    panel.background = element_rect(fill = "white", color = NA),
    plot.background = element_rect(fill = "white", color = NA),
    axis.line.x = element_line(color = "black"),
    plot.margin = margin(10, 60, 10, 10)
  ) +
  coord_flip()
```

## Consolidated Results: Summary

### Table 7. Consolidated Frequency Analysis of All Items

```{r frequency-table-consolidated}
#| fig-cap: "Note: Alternative of the above frequency tables."
all_items_df <- df_factor %>%
  select(
    all_of(qr_core_likert),
    all_of(qr_impr_conf),
    all_of(frq_qr_eng)
  )

tbl <- all_items_df %>%
  tbl_summary(
    statistic = everything() ~ "{n} ({p}%)",
    missing = "no"
  ) %>%
  modify_header(label = "All Items") %>%
  italicize_levels() %>%
  modify_table_body(
    ~ .x %>%
      dplyr::mutate(
        label = dplyr::if_else(variable != lag(variable) | is.na(lag(variable)), label, paste0("    ", label))
      )
  )

tbl_flex <- as_flex_table(tbl) %>%
  flextable::width(j = 1, width = 5) %>%
  flextable::width(j = 2, width = 2) %>%
  flextable::font(fontname = "Arial", part = "all") %>%
  flextable::fontsize(size = 11, part = "all") %>%
  flextable::padding(padding = 1, part = "all")

tbl_flex
```

### Figure 7. Consolidated Frequency Analysis of All Items

```{r frequency-graph-consolidated, fig.width=13, fig.height=11}
#| fig-cap: "Note 1: Alternative of the above frequency graphs.<br>Note 2: Different response scales are used: QR Core Skills & QR Engagement (1-4: Never to Frequently), QR Improvement (1-4: None to Major improvement), and Confidence (1-4: Not at all confident to Very confident)."

value_labels <- c("1" = "1", "2" = "2", "3" = "3", "4" = "4")

graph <- df_numeric %>%  
  select(all_of(c(qr_core_likert, qr_impr_conf, frq_qr_eng))) %>%  
  plot_stackfrq(
    sort.frq = "last.desc", 
    coord.flip = TRUE, 
    geom.colors = "Blues", 
    show.total = FALSE,
    legend.labels = value_labels,
    axis.labels = c(shortlabels[qr_core_likert], 
                   shortlabels[qr_impr_conf], 
                   shortlabels[frq_qr_eng]))

graph + theme(
  axis.text.x = element_text(size=14),  
  axis.text.y = element_text(size=14),  
  plot.title = element_text(size=14),  
  legend.text = element_text(16),
  legend.position = "bottom")
```

### Table 8. Consolidated Descriptive Statistics of All Items

```{r descriptive-table-consolidated, fig.width=13, fig.height=11}
#| fig-cap: "Note: Alternative of the above descriptive statistics tables."
if (length(frq_qr_eng) > 0) {
  all_vars <- c(qr_core_likert, qr_impr_conf, frq_qr_eng)
  means <- sapply(df_numeric[all_vars], mean, na.rm = TRUE)
  sorted_vars <- names(sort(means, decreasing = TRUE))

  tbl <- df_numeric %>%
    select(all_of(sorted_vars)) %>%
    tbl_summary(
      type = everything() ~ "continuous", 
      statistic = everything() ~ "{mean} ({sd})",
      digits = everything() ~ 2, 
      missing = "no"
    ) %>%
    modify_header(label = "All Items")

  tbl_flex <- as_flex_table(tbl) %>%
    flextable::width(j = 1, width = 5) %>%
    flextable::width(j = 2, width = 2) %>%
    flextable::font(fontname = "Arial", part = "all") %>%
    flextable::fontsize(size = 10, part = "all") %>%
    flextable::padding(padding = 4, part = "all")

  tbl_flex
}
```

### Figure 8. Consolidated Descriptive Statistics of All Items

```{r descriptive-figure-consolidated, fig.width=12, fig.height=9}
#| fig-cap: "Note 1: Alternative of the above descriptive statistics graphs.<br>Note 2: Different response scales are used: Core QR Skills & QR Engagement (1-4: Never to Frequently), QR Improvement (1-4: None to Major improvement), and Confidence (1-4: Not at all confident to Very confident)."

all_vars <- c(qr_core_likert, qr_impr_conf, frq_qr_eng)

stats_df <- data.frame(
  variable = all_vars,
  stringsAsFactors = FALSE
)

for(var in all_vars) {
  stats_df$mean[stats_df$variable == var] <- mean(df_numeric[[var]], na.rm = TRUE)
  stats_df$sd[stats_df$variable == var] <- sd(df_numeric[[var]], na.rm = TRUE)
}

stats_df$category <- NA
stats_df$category[stats_df$variable %in% qr_core_likert] <- "Core QR Skills"
stats_df$category[stats_df$variable %in% qr_impr_conf] <- "QR Improvement & Confidence"
stats_df$category[stats_df$variable %in% frq_qr_eng] <- "Frequency of QR Engagement"

stats_df$label <- unlist(shortlabels[stats_df$variable])
stats_df$stat_label <- sprintf("%.2f (%.2f)", stats_df$mean, stats_df$sd)

ggplot(stats_df, aes(x = reorder(label, mean), y = mean, fill = category)) +
  geom_col(width = 0.7) +
  geom_text(aes(label = stat_label), 
            hjust = -0.1,
            size = 4,
            color = "black") +
  scale_fill_manual(values = c("Core QR Skills" = "#4682B4", 
                              "QR Improvement & Confidence" = "#6CA6CD", 
                              "Frequency of QR Engagement" = "#87CEEB")) +
  scale_y_continuous(
    limits = c(0, 4.0),
    breaks = 1:4,
    labels = c("1", "2", "3", "4"),
    expand = expansion(mult = c(0, 0.2))
  ) +
  labs(
    x = "",
    y = "Mean (SD) (1-4 scale)",
    fill = "Variable Category"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 13),
    axis.text.y = element_text(size = 13),
    axis.title.x = element_text(size = 13),
    legend.position = "bottom",
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11),
    panel.grid.minor = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.major.x = element_line(color = "lightgray"),
    panel.background = element_rect(fill = "white", color = NA),
    plot.background = element_rect(fill = "white", color = NA),
    axis.line.x = element_line(color = "black"),
    plot.margin = margin(10, 100, 10, 10),
  ) +
  coord_flip()
```

# Correlation Analyses

## Figure 9. Correlation Matrix of All Variables

```{r correlation-matrix-core, fig.width=18, fig.height=15}
#| fig-cap: "Note: Bottom-left cells show scatterplots; diagonal cells show variable distributions. Top-right values are Pearson *r* coefficients. Correlation strength: weak (|r| < 0.3), moderate (0.3 < |r| < 0.5), strong (|r| > 0.5). * p < .05, ** p < .01, *** p < .001."

df_pairs <- df_numeric[, c("q1_methodology", "q2_calculation", "q3_visual_representation", 
                           "q4_interpretation", "q5_evaluation", "q6_coherence_purpose", 
                           "q7_reasonableness", "q9_improve_general", "q10_improve_realworld", "q11_confidence",
                           "q8_used_qr", "q13_freq_calculations", "q14_freq_graphs_tables", "q15_freq_course_situations"
                           )]
names(df_pairs) <- unlist(shortlabels[names(df_pairs)])

par(mar = c(6, 5, 4, 2) + 0.1)

pairs.panels(
  df_pairs,
  ellipses       = FALSE,
  scale          = FALSE,
  show.points    = FALSE,
  stars          = TRUE,
  ci             = TRUE,  
  cex.labels     = 0.85,
  cex.cor        = 1.2,
  hist.col       = "black", 
  lm.col         = "black", 
  cor.col        = "black",
  col            = "black"
  )
```

**Figure 9** presents the correlation matrix of all variables.

The strongest correlations within the core quantitative reasoning skills are observed between:

-   Coherence/Purpose and Reasonableness (*r* = 0.68, *p*\<0.001)

-   Evaluation and Interpretation (*r* = 0.64, *p*\<0.001)

-   Interpretation and Visual Representation (*r* = 0.61, *p*\<0.001)

These strong correlations may suggest that students who build coherent arguments backed by quantitative evidence also tend to judge the reasonableness of solutions. Students with strong evaluation skills typically have strong interpretation abilities, and those who interpret numerical information also create visual representations of data.

The correlation between "How much has this course improved your general quantitative/numerical skills?" and "How much has this course improved your ability to apply QR to real-world problems?" (*r* = 0.90, *p*\<0.001). Notably, "Confidence in using numbers" shows no significant correlations with any variables, which may suggest that confidence operates somewhat independently from the reported quantitative reasoning skills, improvement, and engagement.

The "Using quantitative reasoning to examine real-world problems" shows moderate correlations with core quantitative reasoning skills, particularly with Methodology (*r* = 0.55, *p*\<0.001) and Reasonableness (*r* = 0.51, *p*\<0.001). This suggests relationships between classroom-based skills and their application to real-world issues.

Within the qualitative reasoning engagement variables, the analysis reveals a statistically significant correlation (*r* = 0.68, *p*\<0.001) between students' reported frequency of encountering graphs and tables in everyday life and their experience with course-related situations in daily contexts.

The weakest correlations involve "Used quantitative reasoning to examine a real-world problem or issue," which shows moderate correlations with "How frequently do you do calculations in your everyday life?" (*r* = 0.24, *p*\<0.001), "How frequently do you encounter graphs and tables in your everyday life?" (r= 0.26, *p*\<0.001), and "How frequently in your daily life do you encounter situations like those you have learned about in this course?" (*r* = 0.34, *p*\<0.001).

## Figure 10. Correlogram of All Variables

```{r correlogram, fig.width=22, fig.height=20}
#| fig-cap: "Note 1: Alternative of the above graph.<br>Note 2: Cells represent the correlation coefficient between two variables. Blue shows positive correlations, red shows negative correlations, and circle size reflects correlation magnitude. Correlation strength: weak (|r| < 0.3), moderate (0.3 < |r| < 0.5), strong (|r| > 0.5). Insignificant correlations are invisible (p > .05)."
#| warning: false
#| message: false

selectedvariables <- c(
  "q1_methodology", "q2_calculation", "q3_visual_representation", 
  "q4_interpretation", "q5_evaluation", "q6_coherence_purpose", 
  "q7_reasonableness", "q8_used_qr", "q9_improve_general", "q10_improve_realworld",
  "q11_confidence", "q13_freq_calculations", 
  "q14_freq_graphs_tables", "q15_freq_course_situations" 
)
testRes <- cor.mtest(df_numeric[, selectedvariables])
qrrcorr <- rcorr(as.matrix(df_numeric[, selectedvariables]))
qrcoeff <- qrrcorr$r

colnames(qrcoeff) <- unlist(shortlabels[selectedvariables])
rownames(qrcoeff) <- unlist(shortlabels[selectedvariables])
colnames(testRes$p) <- unlist(shortlabels[selectedvariables])
rownames(testRes$p) <- unlist(shortlabels[selectedvariables])

invisible(
  corrplot(
    qrcoeff,
    p.mat = testRes$p,
    method = 'pie',
    type = 'lower',
    tl.srt = 30,  
    insig = 'blank',
    addCoef.col = 'black',
    order = 'original',
    diag = FALSE,
    tl.cex = 1.6,  
    cl.cex = 1.5,
    tl.col = "black", 
    number.cex = 1.8,
    number.font = 1
  )
)
```

# Regression Analyses

## Table 9. Linear Regression Model Predicting Coherence/Purpose

```{r regression-model1}
model1 <- lm(q6_coherence_purpose_cent ~ q1_methodology_cent + q2_calculation_cent +
               q3_visual_representation_cent + q4_interpretation_cent +
               q5_evaluation_cent + q7_reasonableness_cent, data = df_numeric)
coef_table <- summary(model1)$coefficients
conf_int <- confint(model1, level = 0.95)

format_p_with_stars <- function(p) {
  stars <- ""
  if (p < 0.001) stars <- "***"
  else if (p < 0.01) stars <- "**"
  else if (p < 0.05) stars <- "*"
  else if (p < 0.1) stars <- "†"
  
  p_formatted <- ifelse(p < 0.001, "0.000", sprintf("%.3f", p))
  return(list(p_value = p_formatted, stars = stars))
}

table_data <- data.frame(
  Predictors = c("Intercept", "Methodology", "Calculation", "Visual Representation", 
                 "Interpretation", "Evaluation", "Reasonableness"),
  Estimate = sprintf("%.2f", coef_table[,1]),
  Stars = sapply(coef_table[,4], function(p) format_p_with_stars(p)$stars),
  SE = sprintf("%.2f", coef_table[,2]),
  CI = sprintf("[%.2f, %.2f]", conf_int[,1], conf_int[,2]),
  p = sapply(coef_table[,4], function(p) format_p_with_stars(p)$p_value)
)

table_data$Estimate <- paste0(table_data$Estimate, table_data$Stars)
table_data$Stars <- NULL
table_data$SE <- paste0("(", table_data$SE, ")")

tbl_flex <- flextable(table_data) %>%
  set_header_labels(
    Predictors = "Predictor",
    Estimate = "Estimate",
    SE = "SE",
    CI = "95% CI",
    p = "p-value"
  ) %>%
  add_header_row(
    values = "Linear Regression Model Predicting Coherence/Purpose",
    colwidths = 5
  ) %>%
  fontsize(size = 10, part = "all") %>%
  font(fontname = "Arial", part = "all") %>%
  width(j = 1, width = 3) %>%
  width(j = 2:5, width = 1.3) %>%
  align(align = "left", j = 1, part = "all") %>%
  align(align = "center", j = 2:5, part = "all") %>%
  padding(padding = 4, part = "all") %>%
  set_table_properties(layout = "autofit")

footer_text <- c(
  "SE = Standard Error, CI = Confidence Interval",
  "† p < .10, * p < .05, ** p < .01, *** p < .001",
  sprintf("R² = %.3f; Adjusted R² = %.3f", summary(model1)$r.squared, summary(model1)$adj.r.squared)
)

combined_footer <- paste(footer_text, collapse = "\n")

tbl_flex <- tbl_flex %>%
  add_footer_lines(values = combined_footer) %>%
  fontsize(size = 10, part = "footer") %>%
  font(fontname = "Arial", part = "footer") %>%
  padding(padding = 2, part = "footer")

tbl_flex
```

A linear regression was conducted to identify the factors that influence students’ ability to construct a single, coherent argument using several conclusions based on quantitative evidence—referred to as "Coherence/Purpose." This item received the lowest "frequently" responses at 34.2%, as noted in prior sections. Note that all variables were mean-centered prior to analyses to minimize multicollinearity.

The results reveal that four skills significantly influence the ability to construct coherent quantitative arguments. Specifically, the skill of describing the methods used to solve a quantitative problem and justifying their appropriateness increases the "Coherence/Purpose" score by 0.21 points on a 1-to-4 scale. Similarly, the ability to reach conclusions based on one’s own analysis of numerical information, such as numbers, graphs, or statistics, increases the score by 0.24 points. The most substantial impact arises from deciding when a solution or inference is reasonable within a problem’s context, which increases the Coherence/Purpose score by 0.53 points. Finally, "Carried out calculations, either by hand or using software” shows a negative effect, decreasing the Coherence/Purpose score by 0.11 points. This effect is significant at a marginal level (*p* \< 0.10), a less reliable but noteworthy influence that warrants further exploration. The model explains approximately 51.1% of the variance in "Coherence/Purpose" (R² = 0.511).

## Table 11. Linear Regression Model Predicting Core Quantitative Reasoning Improvement

```{r regression-model2}
model2 <- lm(qr_improvement_index_cent  ~ qr_skills_index_cent + q11_confidence_cent + qr_engagement_index_cent, data = df_numeric)
coef_table <- summary(model2)$coefficients
conf_int <- confint(model2, level = 0.95)

format_p_with_stars <- function(p) {
  stars <- ""
  if (p < 0.001) stars <- "***"
  else if (p < 0.01) stars <- "**"
  else if (p < 0.05) stars <- "*"
  else if (p < 0.1) stars <- "†"
  
  p_formatted <- ifelse(p < 0.001, "0.000", sprintf("%.3f", p))
  return(list(p_value = p_formatted, stars = stars))
}

table_data <- data.frame(
  Predictors = c("Intercept", "QR Core Skills", "Confidence",  "QR Engagement"),
  Estimate = sprintf("%.2f", coef_table[,1]),
  Stars = sapply(coef_table[,4], function(p) format_p_with_stars(p)$stars),
  SE = sprintf("%.2f", coef_table[,2]),
  CI = sprintf("[%.2f, %.2f]", conf_int[,1], conf_int[,2]),
  p = sapply(coef_table[,4], function(p) format_p_with_stars(p)$p_value)
)

table_data$Estimate <- paste0(table_data$Estimate, table_data$Stars)
table_data$Stars <- NULL
table_data$SE <- paste0("(", table_data$SE, ")")

tbl_flex <- flextable(table_data) %>%
  set_header_labels(
    Predictors = "Predictor",
    Estimate = "Estimate",
    SE = "SE",
    CI = "95% CI",
    p = "p-value"
  ) %>%
  add_header_row(
    values = "Linear Regression Model Predicting QR Improvement",
    colwidths = 5
  ) %>%
  fontsize(size = 10, part = "all") %>%
  font(fontname = "Arial", part = "all") %>%
  width(j = 1, width = 3) %>%
  width(j = 2:5, width = 1.3) %>%
  align(align = "left", j = 1, part = "all") %>%
  align(align = "center", j = 2:5, part = "all") %>%
  padding(padding = 4, part = "all") %>%
  set_table_properties(layout = "autofit")

footer_text <- c(
  "SE = Standard Error, CI = Confidence Interval",
  "† p < .10, * p < .05, ** p < .01, *** p < .001",
  sprintf("R² = %.3f; Adjusted R² = %.3f", summary(model2)$r.squared, summary(model2)$adj.r.squared)
)

combined_footer <- paste(footer_text, collapse = "\n")

tbl_flex <- tbl_flex %>%
  add_footer_lines(values = combined_footer) %>%
  fontsize(size = 10, part = "footer") %>%
  font(fontname = "Arial", part = "footer") %>%
  padding(padding = 2, part = "footer")

tbl_flex
```

A linear regression was conducted to identify the factors that influence students’ self-reported improvement. For this analysis, composite indexes were used.

The results reveal that quantitative reasoning core skills increases the improvement score by 0.55 points on a 1-to-4 scale. Similarly, qualitative reasoning engagement increases the score by 0.29 points. However, confidence has no effect on the improvement score. The model explains approximately 43% of the variance in "Coherence/Purpose" (R² = 0.430).
